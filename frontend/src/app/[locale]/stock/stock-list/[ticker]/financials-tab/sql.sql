CREATE TABLE FMP_INCOME_STATEMENT (
    SYMBOL VARCHAR(50) NOT NULL,
    FILLING_DATE VARCHAR(50) NOT NULL,
    DATE VARCHAR(50),
    REPORTED_CURRENCY VARCHAR(10),
    CIK VARCHAR(20),
    ACCEPTED_DATE DATETIME,
    CALENDAR_YEAR VARCHAR(10),
    PERIOD VARCHAR(10),
    REVENUE BIGINT,
    COST_OF_REVENUE BIGINT,
    GROSS_PROFIT BIGINT,
    GROSS_PROFIT_RATIO DECIMAL(10, 5),
    RESEARCH_AND_DEVELOPMENT_EXPENSES BIGINT,
    SELLING_AND_MARKETING_EXPENSES BIGINT,
    GENERAL_AND_ADMINISTRATIVE_EXPENSES BIGINT,
    SELLING_GENERAL_AND_ADMINISTRATIVE_EXPENSES BIGINT,
    OTHER_EXPENSES BIGINT,
    OPERATING_EXPENSES BIGINT,
    COST_AND_EXPENSES BIGINT,
    INTEREST_INCOME BIGINT,
    INTEREST_EXPENSE BIGINT,
    DEPRECIATION_AND_AMORTIZATION BIGINT,
    EBITDA BIGINT,
    EBITDARATIO DECIMAL(10, 5),
    OPERATING_INCOME BIGINT,
    OPERATING_INCOME_RATIO DECIMAL(10, 5),
    TOTAL_OTHER_INCOME_EXPENSES_NET BIGINT,
    INCOME_BEFORE_TAX BIGINT,
    INCOME_BEFORE_TAX_RATIO DECIMAL(10, 5),
    INCOME_TAX_EXPENSE BIGINT,
    NET_INCOME BIGINT,
    NET_INCOME_RATIO DECIMAL(10, 5),
    EPS DECIMAL(10, 2),
    EPS_DILUTED DECIMAL(10, 2),
    WEIGHTED_AVERAGE_SHS_OUT BIGINT,
    WEIGHTED_AVERAGE_SHS_OUT_DIL BIGINT,
    LINK VARCHAR(500),
    FINAL_LINK VARCHAR(500),
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (SYMBOL, FILLING_DATE)
);

[
  {
    "date": "2022-09-24",
    "symbol": "AAPL",
    "reportedCurrency": "USD",
    "cik": "0000320193",
    "fillingDate": "2022-10-28",
    "acceptedDate": "2022-10-27 18:01:14",
    "calendarYear": "2022",
    "period": "FY",
    "revenue": 394328000000,
    "costOfRevenue": 223546000000,
    "grossProfit": 170782000000,
    "grossProfitRatio": 0.4330963056,
    "researchAndDevelopmentExpenses": 26251000000,
    "generalAndAdministrativeExpenses": 0,
    "sellingAndMarketingExpenses": 0,
    "sellingGeneralAndAdministrativeExpenses": 25094000000,
    "otherExpenses": -334000000,
    "operatingExpenses": 51345000000,
    "costAndExpenses": 274891000000,
    "interestIncome": 2825000000,
    "interestExpense": 2931000000,
    "depreciationAndAmortization": 11104000000,
    "ebitda": 130541000000,
    "ebitdaratio": 0.3310467428,
    "operatingIncome": 119437000000,
    "operatingIncomeRatio": 0.302887444,
    "totalOtherIncomeExpensesNet": -334000000,
    "incomeBeforeTax": 119103000000,
    "incomeBeforeTaxRatio": 0.3020404333,
    "incomeTaxExpense": 19300000000,
    "netIncome": 99803000000,
    "netIncomeRatio": 0.2530964071,
    "eps": 6.15,
    "epsdiluted": 6.11,
    "weightedAverageShsOut": 16215963000,
    "weightedAverageShsOutDil": 16325819000,
    "link": "https://www.sec.gov/Archives/edgar/data/320193/000032019322000108/0000320193-22-000108-index.htm",
    "finalLink": "https://www.sec.gov/Archives/edgar/data/320193/000032019322000108/aapl-20220924.htm"
  }
]

SELECT
    REVENUE AS "Total Revenue",
    (REVENUE - TOTAL_OTHER_INCOME_EXPENSES_NET) AS "Operating Revenue",
    COST_OF_REVENUE AS "Cost of Revenue",
    GROSS_PROFIT AS "Gross Profit",
    OPERATING_EXPENSES AS "Operating Expense",
    OPERATING_INCOME AS "Operating Income",
    TOTAL_OTHER_INCOME_EXPENSES_NET AS "Net Non Operating Interest Income Expense",
    OTHER_EXPENSES AS "Other Income Expense",
    INCOME_BEFORE_TAX AS "Pretax Income",
    INCOME_TAX_EXPENSE AS "Tax Provision",
    NET_INCOME AS "Net Income Common Stockholders",
    NET_INCOME AS "Diluted NI Available to Com Stockholders",
    EPS AS "Basic EPS",
    EPS_DILUTED AS "Diluted EPS",
    WEIGHTED_AVERAGE_SHS_OUT AS "Basic Average Shares",
    WEIGHTED_AVERAGE_SHS_OUT_DIL AS "Diluted Average Shares",
    OPERATING_INCOME AS "Total Operating Income as Reported",
    COST_AND_EXPENSES AS "Total Expenses",
    NET_INCOME AS "Net Income from Continuing & Discontinued Operation",
    NET_INCOME AS "Normalized Income",
    INTEREST_EXPENSE AS "Interest Expense",
    (INTEREST_INCOME - INTEREST_EXPENSE) AS "Net Interest Income",
    OPERATING_INCOME AS "EBIT",
    EBITDA AS "EBITDA",
    COST_OF_REVENUE AS "Reconciled Cost of Revenue",
    DEPRECIATION_AND_AMORTIZATION AS "Reconciled Depreciation",
    NET_INCOME AS "Net Income from Continuing Operation Net Minority Interest",
    EBITDA AS "Normalized EBITDA"
FROM 
    FMP_INCOME_STATEMENT
WHERE 
    SYMBOL = 'NXT' -- 특정 종목 코드
    AND PERIOD = 'FY' -- 연간 보고서만
    AND CALENDAR_YEAR >= YEAR(CURDATE()) - 5 -- 최근 5개년 기준
ORDER BY 
    CALENDAR_YEAR DESC;
